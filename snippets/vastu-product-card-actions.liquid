{% comment %}
  Prevents card link from being triggered when clicking on add to cart/select options button
{% endcomment %}

<script>
(function() {
  const processedCards = new WeakSet();
  
  function setupOverlayHandlers() {
    // Handle best seller cards - prevent link navigation when clicking overlay
    document.querySelectorAll('.vastu-best-seller-card__actions-overlay').forEach(function(overlay) {
      if (processedCards.has(overlay)) return;
      processedCards.add(overlay);
      
      // Stop propagation on overlay to prevent card link navigation
      overlay.addEventListener('click', function(e) {
        e.stopPropagation();
      }, true);
      
      // Prevent the card link from receiving clicks from overlay
      const cardLink = overlay.closest('.vastu-best-seller-card')?.querySelector('.vastu-best-seller-card__link');
      if (cardLink && !cardLink.dataset.vastuHandlerAdded) {
        cardLink.dataset.vastuHandlerAdded = 'true';
        cardLink.addEventListener('click', function(e) {
          // If click originated from overlay, prevent navigation
          if (e.target.closest('.vastu-best-seller-card__actions-overlay')) {
            e.preventDefault();
            e.stopPropagation();
            return false;
          }
        }, true);
      }
    });
    
    // Handle featured products cards - prevent link navigation when clicking overlay
    document.querySelectorAll('.vastu-featured-products__actions-overlay').forEach(function(overlay) {
      if (processedCards.has(overlay)) return;
      processedCards.add(overlay);
      
      // Stop propagation on overlay to prevent card link navigation
      overlay.addEventListener('click', function(e) {
        e.stopPropagation();
      }, true);
      
      // Prevent the card link from receiving clicks from overlay
      const cardLink = overlay.closest('.vastu-featured-products__card')?.querySelector('.vastu-featured-products__link');
      if (cardLink && !cardLink.dataset.vastuHandlerAdded) {
        cardLink.dataset.vastuHandlerAdded = 'true';
        cardLink.addEventListener('click', function(e) {
          // If click originated from overlay, prevent navigation
          if (e.target.closest('.vastu-featured-products__actions-overlay')) {
            e.preventDefault();
            e.stopPropagation();
            return false;
          }
        }, true);
      }
    });
  }
  
  // Run on DOMContentLoaded
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', setupOverlayHandlers);
  } else {
    setupOverlayHandlers();
  }
  
  // Also run after a short delay to catch dynamically loaded content
  setTimeout(setupOverlayHandlers, 500);
  setTimeout(setupOverlayHandlers, 1000);
})();
</script>

