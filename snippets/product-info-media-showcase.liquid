{% comment %}
  Renders product media for showcase section (based on product-info-media-style1)
  This version ensures images always display with proper fallbacks
  
  Accepts:
   - product: {Product} The product object (required)
   - section: {Section} The section object (optional, for custom image blocks)
   - hover_zoom_enabled: {Boolean} Whether to enable hover zoom (optional)
   - click_zoom_enabled: {Boolean} Whether to enable click zoom (optional)
   - autoplay: {Boolean} Whether to enable video autoplay (optional)
   - video_modal: {Boolean} Whether to enable video style modal (optional)
   - product_360: {Boolean} Whether to enable 360 product view (optional)
   - media_sticky: {Boolean} Enable position sticky (optional)
{% endcomment %}

{{ 'product-info-media-style1.css' | asset_url | stylesheet_tag }}

{% comment %} Ensure product is available {% endcomment %}
{% if product == blank %}
  {% assign product = all_products['vastu-kit-home-office'] %}
{% endif %}

{% comment %} Get featured media - try multiple fallbacks {% endcomment %}
{% assign featured_media = product.selected_or_first_available_variant.featured_media %}
{% if featured_media == blank %}
  {% assign featured_media = product.featured_media %}
{% endif %}
{% if featured_media == blank %}
  {% assign featured_media = product.media.first %}
{% endif %}
{% comment %} Always ensure we have at least featured_image as fallback {% endcomment %}
{% assign featured_image = product.featured_image %}
{% if featured_image == blank %}
  {% assign featured_image = product.images.first %}
{% endif %}
{% assign media_aspect_ratio = settings.product_card_aspect_ratio %}

<div
  class='xo-product-info-media-style1'
  {%- if media_sticky -%}
    style='position: sticky;'
  {%- endif -%}
>
  <xo-gallery xo-sync='false' xo-portal-class='main-product__portal' aria-label='{{ 'products.product.media.gallery_viewer' | t }}'>
    <xo-carousel xo-name='product-information-desktop'>
      <div class='xo-product-info-media-style1__bottom'>
        <xo-carousel-inner>
          <xo-carousel-list role='list' aria-label='{{ 'general.slider.name' | t }}'>
            {% comment %} Custom Image Blocks - Add before product images {% endcomment %}
            {% if section != blank %}
              {% assign custom_image_blocks = section.blocks | where: 'type', 'custom_image' %}
              {% for block in custom_image_blocks %}
                {% if block.settings.image != blank %}
                  <xo-carousel-slide
                    aria-roledescription='{{ 'sections.slideshow.slide' | t }}'
                    aria-label='{{ forloop.index }} {{ 'general.slider.of' | t }} {{ custom_image_blocks.size | plus: product.media.size }}'
                    data-media-id='custom-{{ block.id }}'
                    class='xo-product-info-media-style1__slide'
                    {{ block.shopify_attributes }}
                  >
                    {% if hover_zoom_enabled and click_zoom_enabled == false %}
                      <xo-image-zoom xo-zoom='3' xo-use-wheel='false' xo-zoom-src='{{ block.settings.image | image_url: width: 1200 }}'>
                        <div class='xo-product-info-media-style1__image'>
                          {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: block.settings.image %}
                        </div>
                      </xo-image-zoom>
                    {% elsif hover_zoom_enabled == false and click_zoom_enabled %}
                      <xo-gallery-item xo-src='{{ block.settings.image | image_url: width: 1200 }}'>
                        <div class='xo-product-info-media-style1__image'>
                          {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: block.settings.image %}
                        </div>
                      </xo-gallery-item>
                    {% elsif hover_zoom_enabled and click_zoom_enabled %}
                      <xo-image-zoom xo-zoom='3' xo-use-wheel='false' xo-zoom-src='{{ block.settings.image | image_url: width: 1200 }}'>
                        <xo-gallery-item xo-src='{{ block.settings.image | image_url: width: 1200 }}'>
                          <div class='xo-product-info-media-style1__image'>
                            {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: block.settings.image %}
                          </div>
                        </xo-gallery-item>
                      </xo-image-zoom>
                    {% else %}
                      {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: block.settings.image %}
                    {% endif %}
                  </xo-carousel-slide>
                {% endif %}
              {% endfor %}
            {% endif %}
            
            {% if featured_media != null %}
              {% if featured_media.media_type %}
                {% case featured_media.media_type %}
                  {% when 'image' %}
                    <xo-carousel-slide
                      aria-roledescription='{{ 'sections.slideshow.slide' | t }}'
                      aria-label='1 {{ 'general.slider.of' | t }} {{ product.media.size | default: 1 }}'
                      data-media-id='{{ featured_media.id }}'
                      class='xo-product-info-media-style1__slide'
                    >
                      {% if hover_zoom_enabled and click_zoom_enabled == false %}
                        <xo-image-zoom xo-zoom='3' xo-use-wheel='false' xo-zoom-src='{{ featured_media.src | image_url: width: 1200 }}'>
                          <div class='xo-product-info-media-style1__image'>
                            {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: featured_media %}
                          </div>
                        </xo-image-zoom>
                      {% elsif hover_zoom_enabled == false and click_zoom_enabled %}
                        <xo-gallery-item xo-src='{{ featured_media.src | image_url: width: 1200 }}'>
                          <div class='xo-product-info-media-style1__image'>
                            {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: featured_media %}
                          </div>
                        </xo-gallery-item>
                      {% elsif hover_zoom_enabled and click_zoom_enabled %}
                        <xo-image-zoom xo-zoom='3' xo-use-wheel='false' xo-zoom-src='{{ featured_media.src | image_url: width: 1200 }}'>
                          <xo-gallery-item xo-src='{{ featured_media.src | image_url: width: 1200 }}'>
                            <div class='xo-product-info-media-style1__image'>
                              {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: featured_media %}
                            </div>
                          </xo-gallery-item>
                        </xo-image-zoom>
                      {% else %}
                        {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: featured_media %}
                      {% endif %}
                    </xo-carousel-slide>
                  {% when 'model' %}
                    <xo-carousel-slide
                      aria-roledescription='{{ 'sections.slideshow.slide' | t }}'
                      aria-label='1 {{ 'general.slider.of' | t }} {{ product.media.size | default: 1 }}'
                      data-media-id='{{ featured_media.id }}'
                      class='xo-product-info-media-style1__slide'
                    >
                      <xo-product-model>
                        <button class='xb-product-model__poster' type='button'>
                          <span class='xb-product-model__poster-button'>
                            {% render 'icon', name: '3d-model', icon_size: '20' %}
                          </span>
                          <div class='xb-product-model__poster-image' style='--media-aspect-ratio: {{ media_aspect_ratio }}'>
                            <img
                              is='xo-lazyload'
                              loading='lazy'
                              width='{{ featured_media.preview_image.width }}'
                              height='{{ featured_media.preview_image.height }}'
                              src='{{ featured_media.preview_image | image_url: width: 533 }}'
                              alt='{{ featured_media.alt | escape }}'
                            >
                          </div>
                        </button>
                        <template>
                          {{ featured_media | model_viewer_tag: image_size: '1024x', toggleable: true }}
                        </template>
                      </xo-product-model>
                    </xo-carousel-slide>
                  {% else %}
                    {% if video_modal == false and product_360 == false %}
                      <xo-carousel-slide
                        aria-roledescription='{{ 'sections.slideshow.slide' | t }}'
                        aria-label='1 {{ 'general.slider.of' | t }} {{ product.media.size | default: 1 }}'
                        data-media-id='{{ featured_media.id }}'
                        class='xo-product-info-media-style1__slide'
                      >
                        {% render 'media', media_aspect_ratio: media_aspect_ratio, type: featured_media.media_type, media: featured_media, autoplay: autoplay %}
                      </xo-carousel-slide>
                    {% endif %}
                {% endcase %}
              {% else %}
                <xo-carousel-slide
                  aria-roledescription='{{ 'sections.slideshow.slide' | t }}'
                  aria-label='1 {{ 'general.slider.of' | t }} {{ product.media.size | default: 1 }}'
                  data-media-id='{{ featured_media.id }}'
                  class='xo-product-info-media-style1__slide'
                >
                  {% if hover_zoom_enabled and click_zoom_enabled == false %}
                    <xo-image-zoom xo-zoom='3' xo-use-wheel='false' xo-zoom-src='{{ featured_media.src | image_url: width: 1200 }}'>
                      <div class='xo-product-info-media-style1__image'>
                        {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: featured_media %}
                      </div>
                    </xo-image-zoom>
                  {% elsif hover_zoom_enabled == false and click_zoom_enabled %}
                    <xo-gallery-item xo-src='{{ featured_media.src | image_url: width: 1200 }}'>
                      <div class='xo-product-info-media-style1__image'>
                        {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: featured_media %}
                      </div>
                    </xo-gallery-item>
                  {% elsif hover_zoom_enabled and click_zoom_enabled %}
                    <xo-image-zoom xo-zoom='3' xo-use-wheel='false' xo-zoom-src='{{ featured_media.src | image_url: width: 1200 }}'>
                      <xo-gallery-item xo-src='{{ featured_media.src | image_url: width: 1200 }}'>
                        <div class='xo-product-info-media-style1__image'>
                          {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: featured_media %}
                        </div>
                      </xo-gallery-item>
                    </xo-image-zoom>
                  {% else %}
                    {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: featured_media %}
                  {% endif %}
                </xo-carousel-slide>
              {% endif %}
            {% elsif featured_image != blank %}
              <xo-carousel-slide
                aria-roledescription='{{ 'sections.slideshow.slide' | t }}'
                aria-label='1 {{ 'general.slider.of' | t }} 1'
                data-media-id='{{ featured_image.id }}'
                class='xo-product-info-media-style1__slide'
              >
                {% if hover_zoom_enabled and click_zoom_enabled == false %}
                  <xo-image-zoom xo-zoom='3' xo-use-wheel='false' xo-zoom-src='{{ featured_image | image_url: width: 1200 }}'>
                    <div class='xo-product-info-media-style1__image'>
                      {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: featured_image %}
                    </div>
                  </xo-image-zoom>
                {% elsif hover_zoom_enabled == false and click_zoom_enabled %}
                  <xo-gallery-item xo-src='{{ featured_image | image_url: width: 1200 }}'>
                    <div class='xo-product-info-media-style1__image'>
                      {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: featured_image %}
                    </div>
                  </xo-gallery-item>
                {% elsif hover_zoom_enabled and click_zoom_enabled %}
                  <xo-image-zoom xo-zoom='3' xo-use-wheel='false' xo-zoom-src='{{ featured_image | image_url: width: 1200 }}'>
                    <xo-gallery-item xo-src='{{ featured_image | image_url: width: 1200 }}'>
                      <div class='xo-product-info-media-style1__image'>
                        {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: featured_image %}
                      </div>
                    </xo-gallery-item>
                  </xo-image-zoom>
                {% else %}
                  {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: featured_image %}
                {% endif %}
              </xo-carousel-slide>
            {% endif %}
            {% if product.media.size > 0 %}
              {% for media in product.media %}
                {% if featured_media != null and featured_media.id %}
                  {% unless media.id == featured_media.id %}
                    {% case media.media_type %}
                      {% when 'image' %}
                        <xo-carousel-slide
                          aria-roledescription='{{ 'sections.slideshow.slide' | t }}'
                          aria-label='{{ forloop.index | plus: 1 }} {{ 'general.slider.of' | t }} {{ product.media.size }}'
                          data-media-id='{{ media.id }}'
                          class='xo-product-info-media-style1__slide'
                        >
                          {% if hover_zoom_enabled and click_zoom_enabled == false %}
                            <xo-image-zoom xo-zoom='3' xo-use-wheel='false' xo-zoom-src='{{ media.src | image_url: width: 1200 }}'>
                              <div class='xo-product-info-media-style1__image'>
                                {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: media %}
                              </div>
                            </xo-image-zoom>
                          {% elsif hover_zoom_enabled == false and click_zoom_enabled %}
                            <xo-gallery-item xo-src='{{ media.src | image_url: width: 1200 }}'>
                              <div class='xo-product-info-media-style1__image'>
                                {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: media %}
                              </div>
                            </xo-gallery-item>
                          {% elsif hover_zoom_enabled and click_zoom_enabled %}
                            <xo-image-zoom xo-zoom='3' xo-use-wheel='false' xo-zoom-src='{{ media.src | image_url: width: 1200 }}'>
                              <xo-gallery-item xo-src='{{ media.src | image_url: width: 1200 }}'>
                                <div class='xo-product-info-media-style1__image'>
                                  {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: media %}
                                </div>
                              </xo-gallery-item>
                            </xo-image-zoom>
                          {% else %}
                            {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: media %}
                          {% endif %}
                        </xo-carousel-slide>
                      {% when 'model' %}
                        <xo-carousel-slide
                          aria-roledescription='{{ 'sections.slideshow.slide' | t }}'
                          aria-label='{{ forloop.index | plus: 1 }} {{ 'general.slider.of' | t }} {{ product.media.size }}'
                          data-media-id='{{ media.id }}'
                          class='xo-product-info-media-style1__slide'
                        >
                          <xo-product-model>
                            <button class='xb-product-model__poster' type='button'>
                              <span class='xb-product-model__poster-button'>
                                {% render 'icon', name: '3d-model', icon_size: '20' %}
                              </span>
                              <div class='xb-product-model__poster-image' style='--media-aspect-ratio: {{ media_aspect_ratio }}'>
                                <img
                                  is='xo-lazyload'
                                  loading='lazy'
                                  width='{{ media.preview_image.width }}'
                                  height='{{ media.preview_image.height }}'
                                  src='{{ media.preview_image | image_url: width: 533 }}'
                                  alt='{{ media.alt | escape }}'
                                >
                              </div>
                            </button>
                            <template>
                              {{ media | model_viewer_tag: image_size: '1024x', toggleable: true }}
                            </template>
                          </xo-product-model>
                        </xo-carousel-slide>
                      {% else %}
                        {% if video_modal == false and product_360 == false %}
                          <xo-carousel-slide
                            aria-roledescription='{{ 'sections.slideshow.slide' | t }}'
                            aria-label='{{ forloop.index | plus: 1 }} {{ 'general.slider.of' | t }} {{ product.media.size }}'
                            data-media-id='{{ media.id }}'
                            class='xo-product-info-media-style1__slide'
                          >
                            {% render 'media', media_aspect_ratio: media_aspect_ratio, type: media.media_type, media: media, autoplay: autoplay %}
                          </xo-carousel-slide>
                        {% endif %}
                    {% endcase %}
                  {% endunless %}
                {% else %}
                  {% case media.media_type %}
                    {% when 'image' %}
                      <xo-carousel-slide
                        aria-roledescription='{{ 'sections.slideshow.slide' | t }}'
                        aria-label='{{ forloop.index }} {{ 'general.slider.of' | t }} {{ forloop.length }}'
                        data-media-id='{{ media.id }}'
                        class='xo-product-info-media-style1__slide'
                      >
                        {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: media %}
                      </xo-carousel-slide>
                    {% when 'model' %}
                      <xo-carousel-slide
                        aria-roledescription='{{ 'sections.slideshow.slide' | t }}'
                        aria-label='{{ forloop.index }} {{ 'general.slider.of' | t }} {{ forloop.length }}'
                        data-media-id='{{ media.id }}'
                        class='xo-product-info-media-style1__slide'
                      >
                        <xo-product-model>
                          <button class='xb-product-model__poster' type='button'>
                            <span class='xb-product-model__poster-button'>
                              {% render 'icon', name: '3d-model', icon_size: '20' %}
                            </span>
                            <div class='xb-product-model__poster-image' style='--media-aspect-ratio: {{ media_aspect_ratio }}'>
                              <img
                                is='xo-lazyload'
                                loading='lazy'
                                width='{{ media.preview_image.width }}'
                                height='{{ media.preview_image.height }}'
                                src='{{ media.preview_image | image_url: width: 533 }}'
                                alt='{{ media.alt | escape }}'
                              >
                            </div>
                          </button>
                          <template>
                            {{ media | model_viewer_tag: image_size: '1024x', toggleable: true }}
                          </template>
                        </xo-product-model>
                      </xo-carousel-slide>
                    {% else %}
                      {% if video_modal == false and product_360 == false %}
                        <xo-carousel-slide
                          aria-roledescription='{{ 'sections.slideshow.slide' | t }}'
                          aria-label='{{ forloop.index }} {{ 'general.slider.of' | t }} {{ forloop.length }}'
                          data-media-id='{{ media.id }}'
                          class='xo-product-info-media-style1__slide'
                        >
                          {% render 'media', media_aspect_ratio: media_aspect_ratio, type: media.media_type, media: media, autoplay: autoplay %}
                        </xo-carousel-slide>
                      {% endif %}
                  {% endcase %}
                {% endif %}
              {% endfor %}
            {% elsif product.images.size > 0 %}
              {% for image in product.images %}
                <xo-carousel-slide
                  aria-roledescription='{{ 'sections.slideshow.slide' | t }}'
                  aria-label='{{ forloop.index }} {{ 'general.slider.of' | t }} {{ forloop.length }}'
                  data-media-id='{{ image.id }}'
                  class='xo-product-info-media-style1__slide'
                >
                  {% if hover_zoom_enabled and click_zoom_enabled == false %}
                    <xo-image-zoom xo-zoom='3' xo-use-wheel='false' xo-zoom-src='{{ image | image_url: width: 1200 }}'>
                      <div class='xo-product-info-media-style1__image'>
                        {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: image %}
                      </div>
                    </xo-image-zoom>
                  {% elsif hover_zoom_enabled == false and click_zoom_enabled %}
                    <xo-gallery-item xo-src='{{ image | image_url: width: 1200 }}'>
                      <div class='xo-product-info-media-style1__image'>
                        {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: image %}
                      </div>
                    </xo-gallery-item>
                  {% elsif hover_zoom_enabled and click_zoom_enabled %}
                    <xo-image-zoom xo-zoom='3' xo-use-wheel='false' xo-zoom-src='{{ image | image_url: width: 1200 }}'>
                      <xo-gallery-item xo-src='{{ image | image_url: width: 1200 }}'>
                        <div class='xo-product-info-media-style1__image'>
                          {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: image %}
                        </div>
                      </xo-gallery-item>
                    </xo-image-zoom>
                  {% else %}
                    {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: image %}
                  {% endif %}
                </xo-carousel-slide>
              {% endfor %}
            {% elsif featured_image != blank %}
              <xo-carousel-slide
                aria-roledescription='{{ 'sections.slideshow.slide' | t }}'
                aria-label='1 {{ 'general.slider.of' | t }} 1'
                data-media-id='{{ featured_image.id }}'
                class='xo-product-info-media-style1__slide'
              >
                {% if hover_zoom_enabled and click_zoom_enabled == false %}
                  <xo-image-zoom xo-zoom='3' xo-use-wheel='false' xo-zoom-src='{{ featured_image | image_url: width: 1200 }}'>
                    <div class='xo-product-info-media-style1__image'>
                      {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: featured_image %}
                    </div>
                  </xo-image-zoom>
                {% elsif hover_zoom_enabled == false and click_zoom_enabled %}
                  <xo-gallery-item xo-src='{{ featured_image | image_url: width: 1200 }}'>
                    <div class='xo-product-info-media-style1__image'>
                      {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: featured_image %}
                    </div>
                  </xo-gallery-item>
                {% elsif hover_zoom_enabled and click_zoom_enabled %}
                  <xo-image-zoom xo-zoom='3' xo-use-wheel='false' xo-zoom-src='{{ featured_image | image_url: width: 1200 }}'>
                    <xo-gallery-item xo-src='{{ featured_image | image_url: width: 1200 }}'>
                      <div class='xo-product-info-media-style1__image'>
                        {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: featured_image %}
                      </div>
                    </xo-gallery-item>
                  </xo-image-zoom>
                {% else %}
                  {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: featured_image %}
                {% endif %}
              </xo-carousel-slide>
            {% endif %}
          </xo-carousel-list>
        </xo-carousel-inner>
        {% if video_modal and product.metafields.custom.video_embed != blank %}
          {% render 'popup-video', name: 'style1' %}
        {% endif %}
        {% if product_360 and product.metafields.custom.product_360 != blank %}
          {% render 'product-360', name: 'style1' %}
        {% endif %}
        <xo-carousel-prev class='xo-product-info-media-style1__arrow xo-product-info-media-style1__arrow--left'
          ><button>{% render 'icon', name: 'arrow-left', icon_size: '12' %}</button></xo-carousel-prev
        >
        <xo-carousel-next class='xo-product-info-media-style1__arrow xo-product-info-media-style1__arrow--right'
          ><button>{% render 'icon', name: 'arrow-right', icon_size: '12' %}</button></xo-carousel-next
        >
      </div>
      <xo-carousel-thumbnail xo-loop class='xo-product-info-media-style1__thumbnails' xo-per-view='5' xo-gap='10'>
        <xo-carousel-inner style='padding-bottom: 0.1rem; margin-bottom: -0.1rem;'>
          <xo-carousel-list role='list' aria-label='{{ 'general.slider.name' | t }}' style='padding-right: 0.2rem; margin-right: -0.2rem;'>
            {% comment %} Custom Image Blocks Thumbnails {% endcomment %}
            {% if section != blank %}
              {% assign custom_image_blocks = section.blocks | where: 'type', 'custom_image' %}
              {% for block in custom_image_blocks %}
                {% if block.settings.image != blank %}
                  <xo-carousel-slide
                    aria-roledescription='{{ 'sections.slideshow.slide' | t }}'
                    aria-label='{{ forloop.index }} {{ 'general.slider.of' | t }} {{ custom_image_blocks.size | plus: product.media.size }}'
                    class='xo-product-info-media-style1__thumb-slide'
                    {{ block.shopify_attributes }}
                  >
                    {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: block.settings.image %}
                  </xo-carousel-slide>
                {% endif %}
              {% endfor %}
            {% endif %}
            
            {%- if featured_media != null -%}
              {% if featured_media.media_type %}
                {% case featured_media.media_type %}
                  {% when 'image' %}
                    <xo-carousel-slide
                      aria-roledescription='{{ 'sections.slideshow.slide' | t }}'
                      aria-label='1 {{ 'general.slider.of' | t }} {{ product.media.size | default: 1 }}'
                      class='xo-product-info-media-style1__thumb-slide'
                    >
                      {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: featured_media.preview_image %}
                    </xo-carousel-slide>
                  {% when 'model' %}
                    <xo-carousel-slide
                      aria-roledescription='{{ 'sections.slideshow.slide' | t }}'
                      aria-label='1 {{ 'general.slider.of' | t }} {{ product.media.size | default: 1 }}'
                      class='xo-product-info-media-style1__thumb-slide'
                    >
                      {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: featured_media.preview_image %}
                      <div class='xo-product-info-media-style1__media-icon'>
                        {% render 'icon', name: '3d-model', icon_size: '13' %}
                      </div>
                    </xo-carousel-slide>
                  {% else %}
                    {% if video_modal == false and product_360 == false %}
                      <xo-carousel-slide
                        aria-roledescription='{{ 'sections.slideshow.slide' | t }}'
                        aria-label='1 {{ 'general.slider.of' | t }} {{ product.media.size | default: 1 }}'
                        class='xo-product-info-media-style1__thumb-slide'
                      >
                        {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: featured_media.preview_image %}
                        <div class='xo-product-info-media-style1__media-icon xo-product-info-media-style1__media-icon--play'>
                          {% render 'icon', name: 'play', icon_size: '13' %}
                        </div>
                      </xo-carousel-slide>
                    {% endif %}
                {% endcase %}
              {% else %}
                {% comment %} If featured_media exists but no media_type, treat as image {% endcomment %}
                <xo-carousel-slide
                  aria-roledescription='{{ 'sections.slideshow.slide' | t }}'
                  aria-label='1 {{ 'general.slider.of' | t }} {{ product.media.size | default: 1 }}'
                  class='xo-product-info-media-style1__thumb-slide'
                >
                  {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: featured_media.preview_image %}
                </xo-carousel-slide>
              {% endif %}
            {%- elsif featured_image != blank -%}
              {% comment %} Fallback to featured_image if no featured_media {% endcomment %}
              <xo-carousel-slide
                aria-roledescription='{{ 'sections.slideshow.slide' | t }}'
                aria-label='1 {{ 'general.slider.of' | t }} 1'
                class='xo-product-info-media-style1__thumb-slide'
              >
                {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: featured_image %}
              </xo-carousel-slide>
            {%- endif -%}
            {% if product.media.size > 0 %}
              {% for media in product.media %}
                {% if featured_media != null and featured_media.id %}
                  {% unless media.id == featured_media.id %}
                    {% case media.media_type %}
                      {% when 'image' %}
                        <xo-carousel-slide
                          aria-roledescription='{{ 'sections.slideshow.slide' | t }}'
                          aria-label='{{ forloop.index | plus: 1 }} {{ 'general.slider.of' | t }} {{ product.media.size }}'
                          class='xo-product-info-media-style1__thumb-slide'
                        >
                          {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: media.preview_image %}
                        </xo-carousel-slide>
                      {% when 'model' %}
                        <xo-carousel-slide
                          aria-roledescription='{{ 'sections.slideshow.slide' | t }}'
                          aria-label='{{ forloop.index | plus: 1 }} {{ 'general.slider.of' | t }} {{ product.media.size }}'
                          class='xo-product-info-media-style1__thumb-slide'
                        >
                          {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: media.preview_image %}
                          <div class='xo-product-info-media-style1__media-icon'>
                            {% render 'icon', name: '3d-model', icon_size: '13' %}
                          </div>
                        </xo-carousel-slide>
                      {% else %}
                        {% if video_modal == false and product_360 == false %}
                          <xo-carousel-slide
                            aria-roledescription='{{ 'sections.slideshow.slide' | t }}'
                            aria-label='{{ forloop.index | plus: 1 }} {{ 'general.slider.of' | t }} {{ product.media.size }}'
                            class='xo-product-info-media-style1__thumb-slide'
                          >
                            {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: media.preview_image %}
                            <div class='xo-product-info-media-style1__media-icon xo-product-info-media-style1__media-icon--play'>
                              {% render 'icon', name: 'play', icon_size: '15' %}
                            </div>
                          </xo-carousel-slide>
                        {% endif %}
                    {% endcase %}
                  {% endunless %}
                {% else %}
                  {% comment %} If no featured_media, show all media {% endcomment %}
                  {% case media.media_type %}
                    {% when 'image' %}
                      <xo-carousel-slide
                        aria-roledescription='{{ 'sections.slideshow.slide' | t }}'
                        aria-label='{{ forloop.index }} {{ 'general.slider.of' | t }} {{ forloop.length }}'
                        class='xo-product-info-media-style1__thumb-slide'
                      >
                        {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: media.preview_image %}
                      </xo-carousel-slide>
                    {% when 'model' %}
                      <xo-carousel-slide
                        aria-roledescription='{{ 'sections.slideshow.slide' | t }}'
                        aria-label='{{ forloop.index }} {{ 'general.slider.of' | t }} {{ forloop.length }}'
                        class='xo-product-info-media-style1__thumb-slide'
                      >
                        {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: media.preview_image %}
                        <div class='xo-product-info-media-style1__media-icon'>
                          {% render 'icon', name: '3d-model', icon_size: '13' %}
                        </div>
                      </xo-carousel-slide>
                    {% else %}
                      {% if video_modal == false and product_360 == false %}
                        <xo-carousel-slide
                          aria-roledescription='{{ 'sections.slideshow.slide' | t }}'
                          aria-label='{{ forloop.index }} {{ 'general.slider.of' | t }} {{ forloop.length }}'
                          class='xo-product-info-media-style1__thumb-slide'
                        >
                          {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: media.preview_image %}
                          <div class='xo-product-info-media-style1__media-icon xo-product-info-media-style1__media-icon--play'>
                            {% render 'icon', name: 'play', icon_size: '15' %}
                          </div>
                        </xo-carousel-slide>
                      {% endif %}
                  {% endcase %}
                {% endif %}
              {% endfor %}
            {% elsif product.images.size > 0 %}
              {% comment %} Fallback to product.images if product.media is empty {% endcomment %}
              {% for image in product.images %}
                <xo-carousel-slide
                  aria-roledescription='{{ 'sections.slideshow.slide' | t }}'
                  aria-label='{{ forloop.index }} {{ 'general.slider.of' | t }} {{ forloop.length }}'
                  class='xo-product-info-media-style1__thumb-slide'
                >
                  {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: image %}
                </xo-carousel-slide>
              {% endfor %}
            {% elsif featured_image != blank %}
              {% comment %} Final fallback: use featured_image if nothing else is available {% endcomment %}
              <xo-carousel-slide
                aria-roledescription='{{ 'sections.slideshow.slide' | t }}'
                aria-label='1 {{ 'general.slider.of' | t }} 1'
                class='xo-product-info-media-style1__thumb-slide'
              >
                {% render 'media', media_aspect_ratio: media_aspect_ratio, type: 'image', media: featured_image %}
              </xo-carousel-slide>
            {% endif %}
          </xo-carousel-list>
        </xo-carousel-inner>
      </xo-carousel-thumbnail>
    </xo-carousel>
  </xo-gallery>
</div>
{% render 'product-info-media-mobile',
  product: product,
  hover_zoom_enabled: hover_zoom_enabled,
  click_zoom_enabled: click_zoom_enabled,
  autoplay: autoplay,
  video_modal: video_modal,
  product_360: product_360
%}
